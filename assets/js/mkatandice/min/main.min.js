$(function(){function calculateTotalScore(){var e=0,s=$(".show-grid input");s.each(function(s){var l=0;$(this).val()&&(l="0"==$(this).val()?-2:parseInt($(this).val())),e+=l}),$("#score_total").text(e),$("#score_total_nav").text(e)}function setCellStyle(e){e&&e.val()?e.parent("td").addClass("has-value"):e.parent("td").removeClass("has-value"),e&&"0"==e.val()?(e.val(-2),e.addClass("no-points")):e&&e.val()<0?e.addClass("no-points"):e.removeClass("no-points")}function rollDice(){var sides={1:"brick",2:"ore",3:"wool",4:"lumber",5:"grain",6:"gold"};with(Math)var roll=1+floor(6*random());return sides[roll]}function clearDiceRack(){$(".navbar-dice td").removeClass(),$(".navbar-dice td i").remove()}$(".show-grid input").bind("keyup change",function(){calculateTotalScore(),setCellStyle($(this))}),$("#reset").bind("click",function(e){e.preventDefault(),$("#reset-modal").modal("show")});var rolls_left=3;$("#roll-dice").bind("click",function(){if(rolls_left>0){var e=$(".navbar-dice td");e.each(function(e){$(this).hasClass("hold")||($(this).html('<i class="glyph-icon resources-'+rollDice()+'"></i>'),$(this).addClass("animated rollIn")),$(this).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",function(){$(this).delay(400).queue(function(){$(this).removeClass("animated rollIn").dequeue()})})}),rolls_left-=1}else rolls_left=3,clearDiceRack();var s=$(this).children("#rolls_left_nav");s.addClass("animated wobble"),s.delay(1500).queue(function(){s.removeClass("animated wobble").dequeue()}),$(this).children(".badge").text(rolls_left)}),$("#roll-dice").bind("dblclick",function(){alert("reset")}),$(".navbar-dice td").bind("click",function(){$(this).toggleClass("hold");var e=$(this).children("i");e.hasClass("resources-brick")?$(this).toggleClass("resources-brick-hold"):e.hasClass("resources-lumber")?$(this).toggleClass("resources-lumber-hold"):e.hasClass("resources-ore")?$(this).toggleClass("resources-ore-hold"):e.hasClass("resources-wool")?$(this).toggleClass("resources-wool-hold"):e.hasClass("resources-grain")?$(this).toggleClass("resources-grain-hold"):e.hasClass("resources-gold")&&$(this).toggleClass("resources-gold-hold")}),$('#myTab a[href="#map-nav"]').tab("show"),$('#myTab a[href="#scoreboard-nav"]').tab("show"),$('#myTab a[href="#legend-nav"]').tab("show"),$("#reset-modal").modal({show:!1}),$("#reset-confirm").bind("click",function(e){console.log($(this)),e.preventDefault(),location.reload()})});